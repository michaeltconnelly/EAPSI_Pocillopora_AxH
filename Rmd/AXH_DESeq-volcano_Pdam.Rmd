---
title: "AXH_DESeq-volcano_Pdam"
author: "Mike Connelly"
date: "12/10/2019"
output: html_document
---
Volcano plots

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "~/computing/projects/EAPSI_Pocillopora_AxH/")
```

### Antibiotics vs. Control Differential Expression
```{r}
##Highlight genes that have an absolute fold change > 2 and a padj < 0.01
res_anti_ctrl$threshold <- ifelse(res_anti_ctrl$padj < 0.01 & res_anti_ctrl$log2FoldChange > 0, "Upregulated", ifelse(res_anti_ctrl$padj < 0.01 & res_anti_ctrl$log2FoldChange < 0, "Downregulated", "NA"))
res_anti_ctrl$log10padj <- -log10(res_anti_ctrl$padj)
dat_genes_anti_ctrl_ctrl <- data.frame(cbind(res_anti_ctrl$log2FoldChange, res_anti_ctrl$log10padj, res_anti_ctrl$threshold), stringsAsFactors = FALSE)
colnames(dat_genes_anti_ctrl_ctrl) <- c("log2FoldChange", "log10padj", "threshold")
row.names(dat_genes_anti_ctrl_ctrl) <- res_anti_ctrl$IDGeneInfo
#dat_genes_anti_ctrl_ctrl <- dat_genes_anti_ctrl_ctrl[order(dat_genes_anti_ctrl_ctrl$log2FoldChange, decreasing = TRUE),]
dat_genes_anti_ctrl_ctrl$log2FoldChange <- as.numeric(dat_genes_anti_ctrl_ctrl$log2FoldChange)
dat_genes_anti_ctrl_ctrl$log10padj <- as.numeric(dat_genes_anti_ctrl_ctrl$log10padj)
dat_genes_anti_ctrl_ctrl$threshold <- factor(dat_genes_anti_ctrl_ctrl$threshold, levels = c("Upregulated", "Downregulated", "NA"), ordered = TRUE)
```
```{r, warning = FALSE}
DEGcolors <- c("red", "blue", "black")
pdf(file = "./outputs/DESeq-results/figures/Volcano_anti_ctrl-ctrl.pdf", height = 3, width = 4.25)
gVolcano_anti_ctrl_ctrl <- ggplot(data=dat_genes_anti_ctrl_ctrl, aes(log2FoldChange, log10padj))
gVolcano_anti_ctrl_ctrl + geom_point(aes(color = threshold), alpha=0.7, size=2) +
  scale_color_manual(values = DEGcolors) +
  scale_x_continuous(limits = c(-15,15), breaks = seq(-15,15,5)) + 
  ylim(c(0, 30)) +
  xlab("log2 fold change") +
  ylab("-log10 p-value") + 
  #geom_text_repel(data = dat_genes_anti_ctrl_ctrl[1:15, ], aes(label = rownames(dat_genes_anti_ctrl_ctrl[1:15, ])), color = "black", size = 2.5, box.padding = unit(0.35, "lines")) +
  theme_bw() +
  theme(legend.position = "none",
        panel.background = element_rect(fill = alpha("#99FFFF", 0.5)),
        panel.grid.major = element_line(size = 0.1, linetype = "solid", color = "dark grey"),
        panel.grid.minor = element_blank()) +
  ggtitle("Antibiotics vs. Control")
```

### Heat vs. Control Differential Expression
```{r}
##Highlight genes that have an absolute fold change > 2 and a padj < 0.01
res_heat_ctrl$threshold <- ifelse(res_heat_ctrl$padj < 0.01 & res_heat_ctrl$log2FoldChange > 0, "Upregulated", ifelse(res_heat_ctrl$padj < 0.01 & res_heat_ctrl$log2FoldChange < -0, "Downregulated", "NA"))
res_heat_ctrl$log10padj <- -log10(res_heat_ctrl$padj)
dat_genes_heat_ctrl_ctrl <- data.frame(cbind(res_heat_ctrl$log2FoldChange, res_heat_ctrl$log10padj, res_heat_ctrl$threshold), stringsAsFactors = FALSE)
colnames(dat_genes_heat_ctrl_ctrl) <- c("log2FoldChange", "log10padj", "threshold")
row.names(dat_genes_heat_ctrl_ctrl) <- res_heat_ctrl$IDGeneInfo
#dat_genes_heat_ctrl_ctrl <- dat_genes_heat_ctrl_ctrl[order(dat_genes_heat_ctrl_ctrl$log2FoldChange, decreasing = TRUE),]
dat_genes_heat_ctrl_ctrl$log2FoldChange <- as.numeric(dat_genes_heat_ctrl_ctrl$log2FoldChange)
dat_genes_heat_ctrl_ctrl$log10padj <- as.numeric(dat_genes_heat_ctrl_ctrl$log10padj)
dat_genes_heat_ctrl_ctrl$threshold <- factor(dat_genes_heat_ctrl_ctrl$threshold, levels = c("Upregulated", "Downregulated", "NA"), ordered = TRUE)
```
```{r, warning = FALSE}
DEGcolors <- c("red", "blue", "black")
pdf(file = "./outputs/DESeq-results/figures/Volcano_heat_ctrl-ctrl.pdf", height = 3, width = 4.25)
gVolcano_heat_ctrl_ctrl <- ggplot(data=dat_genes_heat_ctrl_ctrl, aes(log2FoldChange, log10padj))
gVolcano_heat_ctrl_ctrl + geom_point(aes(color = threshold), alpha=0.7, size=2) +
  scale_color_manual(values = DEGcolors) +
  scale_x_continuous(limits = c(-15,15), breaks = seq(-15,15,5)) + 
  ylim(c(0, 30)) +
  xlab("log2 fold change") +
  ylab("-log10 p-value") + 
  #geom_text_repel(data = dat_genes_heat_ctrl_ctrl[1:15, ], aes(label = rownames(dat_genes_heat_ctrl_ctrl[1:15, ])), color = "black", size = 2.5, box.padding = unit(0.35, "lines")) +
  theme_bw() +
  theme(legend.position = "none",
        panel.background = element_rect(fill = alpha("#FFCC99", 0.5)),
        panel.grid.major = element_line(size = 0.1, linetype = "solid", color = "dark grey"),
        panel.grid.minor = element_blank()) +
  ggtitle("Heat vs. Control")
```

### Antibiotics.Heat vs. Control Differential Expression
```{r}
##Highlight genes that have an absolute fold change > 2 and a padj < 0.01
res_anti.heat_ctrl$threshold <- ifelse(res_anti.heat_ctrl$padj < 0.01 & res_anti.heat_ctrl$log2FoldChange > 0, "Upregulated", ifelse(res_anti.heat_ctrl$padj < 0.01 & res_anti.heat_ctrl$log2FoldChange < 0, "Downregulated", "NA"))
res_anti.heat_ctrl$log10padj <- -log10(res_anti.heat_ctrl$padj)
dat_genes_anti.heat_ctrl_ctrl <- data.frame(cbind(res_anti.heat_ctrl$log2FoldChange, res_anti.heat_ctrl$log10padj, res_anti.heat_ctrl$threshold), stringsAsFactors = FALSE)
colnames(dat_genes_anti.heat_ctrl_ctrl) <- c("log2FoldChange", "log10padj", "threshold")
row.names(dat_genes_anti.heat_ctrl_ctrl) <- res_anti.heat_ctrl$IDGeneInfo
#dat_genes_anti.heat_ctrl_ctrl <- dat_genes_anti.heat_ctrl_ctrl[order(dat_genes_anti.heat_ctrl_ctrl$log2FoldChange, decreasing = TRUE),]
dat_genes_anti.heat_ctrl_ctrl$log2FoldChange <- as.numeric(dat_genes_anti.heat_ctrl_ctrl$log2FoldChange)
dat_genes_anti.heat_ctrl_ctrl$log10padj <- as.numeric(dat_genes_anti.heat_ctrl_ctrl$log10padj)
dat_genes_anti.heat_ctrl_ctrl$threshold <- factor(dat_genes_anti.heat_ctrl_ctrl$threshold, levels = c("Upregulated", "Downregulated", "NA"), ordered = TRUE)
```
```{r, warning = FALSE}
DEGcolors <- c("red", "blue", "black")
pdf(file = "./outputs/DESeq-results/figures/Volcano_anti.heat_ctrl-ctrl.pdf", height = 3, width = 4.25)
gVolcano_anti.heat_ctrl_ctrl <- ggplot(data=dat_genes_anti.heat_ctrl_ctrl, aes(log2FoldChange, log10padj))
gVolcano_anti.heat_ctrl_ctrl + geom_point(aes(color = threshold), alpha=0.7, size=2) +
  scale_color_manual(values = DEGcolors) +
  scale_x_continuous(limits = c(-15,15), breaks = seq(-15,15,5)) + 
  ylim(c(0, 30)) +
  xlab("log2 fold change") +
  ylab("-log10 p-value") + 
  #geom_text_repel(data = dat_genes_anti.heat_ctrl_ctrl[1:15, ], aes(label = rownames(dat_genes_anti.heat_ctrl_ctrl[1:15, ])), color = "black", size = 2.5, box.padding = unit(0.35, "lines")) +
  theme_bw() +
  theme(legend.position = "none",
        panel.background = element_rect(fill = alpha("#FFFF66", 0.5)),
        panel.grid.major = element_line(size = 0.1, linetype = "solid", color = "dark grey"),
        panel.grid.minor = element_blank()) +
  ggtitle("Antibiotics + Heat vs. Control")
```

### Antibiotics vs. Control Differential Expression for each colony
```{r}
##Highlight genes that have an absolute fold change > 2 and a padj < 0.01
res_HW1_anti_ctrl$threshold <- ifelse(res_HW1_anti_ctrl$padj < 0.01 & res_HW1_anti_ctrl$log2FoldChange > 0, "Upregulated", ifelse(res_HW1_anti_ctrl$padj < 0.01 & res_HW1_anti_ctrl$log2FoldChange < 0, "Downregulated", "NA"))
res_HW1_anti_ctrl$log10padj <- -log10(res_HW1_anti_ctrl$padj)
dat_genes_HW1_anti_ctrl <- data.frame(cbind(res_HW1_anti_ctrl$log2FoldChange, res_HW1_anti_ctrl$log10padj, res_HW1_anti_ctrl$threshold), stringsAsFactors = FALSE)
colnames(dat_genes_HW1_anti_ctrl) <- c("log2FoldChange", "log10padj", "threshold")
row.names(dat_genes_HW1_anti_ctrl) <- res_HW1_anti_ctrl$IDGeneInfo
#dat_genes_HW1_anti_ctrl <- dat_genes_HW1_anti_ctrl[order(dat_genes_HW1_anti_ctrl$log2FoldChange, decreasing = TRUE),]
dat_genes_HW1_anti_ctrl$log2FoldChange <- as.numeric(dat_genes_HW1_anti_ctrl$log2FoldChange)
dat_genes_HW1_anti_ctrl$log10padj <- as.numeric(dat_genes_HW1_anti_ctrl$log10padj)
dat_genes_HW1_anti_ctrl$threshold <- factor(dat_genes_HW1_anti_ctrl$threshold, levels = c("Upregulated", "Downregulated", "NA"), ordered = TRUE)

res_HW2_anti_ctrl$threshold <- ifelse(res_HW2_anti_ctrl$padj < 0.01 & res_HW2_anti_ctrl$log2FoldChange > 0, "Upregulated", ifelse(res_HW2_anti_ctrl$padj < 0.01 & res_HW2_anti_ctrl$log2FoldChange < 0, "Downregulated", "NA"))
res_HW2_anti_ctrl$log10padj <- -log10(res_HW2_anti_ctrl$padj)
dat_genes_HW2_anti_ctrl <- data.frame(cbind(res_HW2_anti_ctrl$log2FoldChange, res_HW2_anti_ctrl$log10padj, res_HW2_anti_ctrl$threshold), stringsAsFactors = FALSE)
colnames(dat_genes_HW2_anti_ctrl) <- c("log2FoldChange", "log10padj", "threshold")
row.names(dat_genes_HW2_anti_ctrl) <- res_HW2_anti_ctrl$IDGeneInfo
#dat_genes_HW2_anti_ctrl <- dat_genes_HW2_anti_ctrl[order(dat_genes_HW2_anti_ctrl$log2FoldChange, decreasing = TRUE),]
dat_genes_HW2_anti_ctrl$log2FoldChange <- as.numeric(dat_genes_HW2_anti_ctrl$log2FoldChange)
dat_genes_HW2_anti_ctrl$log10padj <- as.numeric(dat_genes_HW2_anti_ctrl$log10padj)
dat_genes_HW2_anti_ctrl$threshold <- factor(dat_genes_HW2_anti_ctrl$threshold, levels = c("Upregulated", "Downregulated", "NA"), ordered = TRUE)

res_WT1_anti_ctrl$threshold <- ifelse(res_WT1_anti_ctrl$padj < 0.01 & res_WT1_anti_ctrl$log2FoldChange > 0, "Upregulated", ifelse(res_WT1_anti_ctrl$padj < 0.01 & res_WT1_anti_ctrl$log2FoldChange < 0, "Downregulated", "NA"))
res_WT1_anti_ctrl$log10padj <- -log10(res_WT1_anti_ctrl$padj)
dat_genes_WT1_anti_ctrl <- data.frame(cbind(res_WT1_anti_ctrl$log2FoldChange, res_WT1_anti_ctrl$log10padj, res_WT1_anti_ctrl$threshold), stringsAsFactors = FALSE)
colnames(dat_genes_WT1_anti_ctrl) <- c("log2FoldChange", "log10padj", "threshold")
row.names(dat_genes_WT1_anti_ctrl) <- res_WT1_anti_ctrl$IDGeneInfo
#dat_genes_WT1_anti_ctrl <- dat_genes_WT1_anti_ctrl[order(dat_genes_WT1_anti_ctrl$log2FoldChange, decreasing = TRUE),]
dat_genes_WT1_anti_ctrl$log2FoldChange <- as.numeric(dat_genes_WT1_anti_ctrl$log2FoldChange)
dat_genes_WT1_anti_ctrl$log10padj <- as.numeric(dat_genes_WT1_anti_ctrl$log10padj)
dat_genes_WT1_anti_ctrl$threshold <- factor(dat_genes_WT1_anti_ctrl$threshold, levels = c("Upregulated", "Downregulated", "NA"), ordered = TRUE)

res_WT2_anti_ctrl$threshold <- ifelse(res_WT2_anti_ctrl$padj < 0.01 & res_WT2_anti_ctrl$log2FoldChange > 0, "Upregulated", ifelse(res_WT2_anti_ctrl$padj < 0.01 & res_WT2_anti_ctrl$log2FoldChange < 0, "Downregulated", "NA"))
res_WT2_anti_ctrl$log10padj <- -log10(res_WT2_anti_ctrl$padj)
dat_genes_WT2_anti_ctrl <- data.frame(cbind(res_WT2_anti_ctrl$log2FoldChange, res_WT2_anti_ctrl$log10padj, res_WT2_anti_ctrl$threshold), stringsAsFactors = FALSE)
colnames(dat_genes_WT2_anti_ctrl) <- c("log2FoldChange", "log10padj", "threshold")
row.names(dat_genes_WT2_anti_ctrl) <- res_WT2_anti_ctrl$IDGeneInfo
#dat_genes_WT2_anti_ctrl <- dat_genes_WT2_anti_ctrl[order(dat_genes_WT2_anti_ctrl$log2FoldChange, decreasing = TRUE),]
dat_genes_WT2_anti_ctrl$log2FoldChange <- as.numeric(dat_genes_WT2_anti_ctrl$log2FoldChange)
dat_genes_WT2_anti_ctrl$log10padj <- as.numeric(dat_genes_WT2_anti_ctrl$log10padj)
dat_genes_WT2_anti_ctrl$threshold <- factor(dat_genes_WT2_anti_ctrl$threshold, levels = c("Upregulated", "Downregulated", "NA"), ordered = TRUE)
```

```{r, warning = FALSE}
DEGcolors <- c("red", "blue", "dark grey")
pdf(file = "./outputs/DESeq-results/figures/Volcano_anti_ctrl_colonies.pdf", height = 3, width = 4.25)
gVolcano_HW1_anti <- ggplot(data=dat_genes_HW1_anti_ctrl, aes(log2FoldChange, log10padj))
gVolcano_HW1_anti + geom_point(aes(color = threshold), alpha=1, size=1) +
  scale_color_manual(values = DEGcolors) +
  scale_x_continuous(limits = c(-10, 10), breaks = seq(-10,10,2)) + 
  ylim(c(0, 20)) +
  xlab("log2 fold change") +
  ylab("-log10 p-value") + 
  #geom_text_repel(data = dat_genes_LPS_ctrl[1:15, ], aes(label = rownames(dat_genes_LPS_ctrl[1:15, ])), color = "black", size = 2.5, box.padding = unit(0.35, "lines")) +
  theme_bw() + ggtitle("") +
  theme(legend.position = "none",
        panel.background = element_rect(fill = alpha("#99FFFF", 0.5)),
         axis.text = element_text(size = 10),
        axis.title = element_text(size = 10))

gVolcano_HW2_anti <- ggplot(data=dat_genes_HW2_anti_ctrl, aes(log2FoldChange, log10padj))
gVolcano_HW2_anti + geom_point(aes(color = threshold), alpha=1, size=1) +
  scale_color_manual(values = DEGcolors) +
  scale_x_continuous(limits = c(-10, 10), breaks = seq(-10,10,2)) + 
  ylim(c(0, 20)) +
  xlab("log2 fold change") +
  ylab("-log10 p-value") + 
  #geom_text_repel(data = dat_genes_LPS_ctrl[1:15, ], aes(label = rownames(dat_genes_LPS_ctrl[1:15, ])), color = "black", size = 2.5, box.padding = unit(0.35, "lines")) +
  theme_bw() + ggtitle("") +
  theme(legend.position = "none",
        panel.background = element_rect(fill = alpha("#99FFFF", 0.5)),
         axis.text = element_text(size = 10),
        axis.title = element_text(size = 10))

gVolcano_WT1_anti <- ggplot(data=dat_genes_WT1_anti_ctrl, aes(log2FoldChange, log10padj))
gVolcano_WT1_anti + geom_point(aes(color = threshold), alpha=1, size=1) +
  scale_color_manual(values = DEGcolors) +
  scale_x_continuous(limits = c(-10, 10), breaks = seq(-10,10,2)) + 
  ylim(c(0, 20)) +
  xlab("log2 fold change") +
  ylab("-log10 p-value") + 
  #geom_text_repel(data = dat_genes_LPS_ctrl[1:15, ], aes(label = rownames(dat_genes_LPS_ctrl[1:15, ])), color = "black", size = 2.5, box.padding = unit(0.35, "lines")) +
  theme_bw() + ggtitle("") +
  theme(legend.position = "none",
        panel.background = element_rect(fill = alpha("#99FFFF", 0.5)),
         axis.text = element_text(size = 10),
        axis.title = element_text(size = 10))

gVolcano_WT2_anti <- ggplot(data=dat_genes_WT2_anti_ctrl, aes(log2FoldChange, log10padj))
gVolcano_WT2_anti + geom_point(aes(color = threshold), alpha=1, size=1) +
  scale_color_manual(values = DEGcolors) +
  scale_x_continuous(limits = c(-10, 10), breaks = seq(-10,10,2)) + 
  ylim(c(0, 20)) +
  xlab("log2 fold change") +
  ylab("-log10 p-value") + 
  #geom_text_repel(data = dat_genes_LPS_ctrl[1:15, ], aes(label = rownames(dat_genes_LPS_ctrl[1:15, ])), color = "black", size = 2.5, box.padding = unit(0.35, "lines")) +
  theme_bw() + ggtitle("") +
  theme(legend.position = "none",
        panel.background = element_rect(fill = alpha("#99FFFF", 0.5)),
         axis.text = element_text(size = 10),
        axis.title = element_text(size = 10))
```

### Heat vs. Control Differential Expression for each colony
```{r}
##Highlight genes that have an absolute fold change > 2 and a padj < 0.01
res_HW1_heat_ctrl$threshold <- ifelse(res_HW1_heat_ctrl$padj < 0.01 & res_HW1_heat_ctrl$log2FoldChange > 0, "Upregulated", ifelse(res_HW1_heat_ctrl$padj < 0.01 & res_HW1_heat_ctrl$log2FoldChange < 0, "Downregulated", "NA"))
res_HW1_heat_ctrl$log10padj <- -log10(res_HW1_heat_ctrl$padj)
dat_genes_HW1_heat_ctrl <- data.frame(cbind(res_HW1_heat_ctrl$log2FoldChange, res_HW1_heat_ctrl$log10padj, res_HW1_heat_ctrl$threshold), stringsAsFactors = FALSE)
colnames(dat_genes_HW1_heat_ctrl) <- c("log2FoldChange", "log10padj", "threshold")
row.names(dat_genes_HW1_heat_ctrl) <- res_HW1_heat_ctrl$IDGeneInfo
#dat_genes_HW1_heat_ctrl <- dat_genes_HW1_heat_ctrl[order(dat_genes_HW1_heat_ctrl$log2FoldChange, decreasing = TRUE),]
dat_genes_HW1_heat_ctrl$log2FoldChange <- as.numeric(dat_genes_HW1_heat_ctrl$log2FoldChange)
dat_genes_HW1_heat_ctrl$log10padj <- as.numeric(dat_genes_HW1_heat_ctrl$log10padj)
dat_genes_HW1_heat_ctrl$threshold <- factor(dat_genes_HW1_heat_ctrl$threshold, levels = c("Upregulated", "Downregulated", "NA"), ordered = TRUE)

res_HW2_heat_ctrl$threshold <- ifelse(res_HW2_heat_ctrl$padj < 0.01 & res_HW2_heat_ctrl$log2FoldChange > 0, "Upregulated", ifelse(res_HW2_heat_ctrl$padj < 0.01 & res_HW2_heat_ctrl$log2FoldChange < 0, "Downregulated", "NA"))
res_HW2_heat_ctrl$log10padj <- -log10(res_HW2_heat_ctrl$padj)
dat_genes_HW2_heat_ctrl <- data.frame(cbind(res_HW2_heat_ctrl$log2FoldChange, res_HW2_heat_ctrl$log10padj, res_HW2_heat_ctrl$threshold), stringsAsFactors = FALSE)
colnames(dat_genes_HW2_heat_ctrl) <- c("log2FoldChange", "log10padj", "threshold")
row.names(dat_genes_HW2_heat_ctrl) <- res_HW2_heat_ctrl$IDGeneInfo
#dat_genes_HW2_heat_ctrl <- dat_genes_HW2_heat_ctrl[order(dat_genes_HW2_heat_ctrl$log2FoldChange, decreasing = TRUE),]
dat_genes_HW2_heat_ctrl$log2FoldChange <- as.numeric(dat_genes_HW2_heat_ctrl$log2FoldChange)
dat_genes_HW2_heat_ctrl$log10padj <- as.numeric(dat_genes_HW2_heat_ctrl$log10padj)
dat_genes_HW2_heat_ctrl$threshold <- factor(dat_genes_HW2_heat_ctrl$threshold, levels = c("Upregulated", "Downregulated", "NA"), ordered = TRUE)

res_WT1_heat_ctrl$threshold <- ifelse(res_WT1_heat_ctrl$padj < 0.01 & res_WT1_heat_ctrl$log2FoldChange > 0, "Upregulated", ifelse(res_WT1_heat_ctrl$padj < 0.01 & res_WT1_heat_ctrl$log2FoldChange < 0, "Downregulated", "NA"))
res_WT1_heat_ctrl$log10padj <- -log10(res_WT1_heat_ctrl$padj)
dat_genes_WT1_heat_ctrl <- data.frame(cbind(res_WT1_heat_ctrl$log2FoldChange, res_WT1_heat_ctrl$log10padj, res_WT1_heat_ctrl$threshold), stringsAsFactors = FALSE)
colnames(dat_genes_WT1_heat_ctrl) <- c("log2FoldChange", "log10padj", "threshold")
row.names(dat_genes_WT1_heat_ctrl) <- res_WT1_heat_ctrl$IDGeneInfo
#dat_genes_WT1_heat_ctrl <- dat_genes_WT1_heat_ctrl[order(dat_genes_WT1_heat_ctrl$log2FoldChange, decreasing = TRUE),]
dat_genes_WT1_heat_ctrl$log2FoldChange <- as.numeric(dat_genes_WT1_heat_ctrl$log2FoldChange)
dat_genes_WT1_heat_ctrl$log10padj <- as.numeric(dat_genes_WT1_heat_ctrl$log10padj)
dat_genes_WT1_heat_ctrl$threshold <- factor(dat_genes_WT1_heat_ctrl$threshold, levels = c("Upregulated", "Downregulated", "NA"), ordered = TRUE)

res_WT2_heat_ctrl$threshold <- ifelse(res_WT2_heat_ctrl$padj < 0.01 & res_WT2_heat_ctrl$log2FoldChange > 0, "Upregulated", ifelse(res_WT2_heat_ctrl$padj < 0.01 & res_WT2_heat_ctrl$log2FoldChange < 0, "Downregulated", "NA"))
res_WT2_heat_ctrl$log10padj <- -log10(res_WT2_heat_ctrl$padj)
dat_genes_WT2_heat_ctrl <- data.frame(cbind(res_WT2_heat_ctrl$log2FoldChange, res_WT2_heat_ctrl$log10padj, res_WT2_heat_ctrl$threshold), stringsAsFactors = FALSE)
colnames(dat_genes_WT2_heat_ctrl) <- c("log2FoldChange", "log10padj", "threshold")
row.names(dat_genes_WT2_heat_ctrl) <- res_WT2_heat_ctrl$IDGeneInfo
#dat_genes_WT2_heat_ctrl <- dat_genes_WT2_heat_ctrl[order(dat_genes_WT2_heat_ctrl$log2FoldChange, decreasing = TRUE),]
dat_genes_WT2_heat_ctrl$log2FoldChange <- as.numeric(dat_genes_WT2_heat_ctrl$log2FoldChange)
dat_genes_WT2_heat_ctrl$log10padj <- as.numeric(dat_genes_WT2_heat_ctrl$log10padj)
dat_genes_WT2_heat_ctrl$threshold <- factor(dat_genes_WT2_heat_ctrl$threshold, levels = c("Upregulated", "Downregulated", "NA"), ordered = TRUE)
```

```{r, warning = FALSE}
DEGcolors <- c("red", "blue", "dark grey")
pdf(file = "./outputs/DESeq-results/figures/Volcano_heat_ctrl_colonies.pdf", height = 3, width = 4.25)
gVolcano_HW1_heat <- ggplot(data=dat_genes_HW1_heat_ctrl, aes(log2FoldChange, log10padj))
gVolcano_HW1_heat + geom_point(aes(color = threshold), alpha=1, size=1) +
  scale_color_manual(values = DEGcolors) +
  scale_x_continuous(limits = c(-10, 10), breaks = seq(-10,10,2)) + 
  ylim(c(0, 20)) +
  xlab("log2 fold change") +
  ylab("-log10 p-value") + 
  #geom_text_repel(data = dat_genes_LPS_ctrl[1:15, ], aes(label = rownames(dat_genes_LPS_ctrl[1:15, ])), color = "black", size = 2.5, box.padding = unit(0.35, "lines")) +
  theme_bw() + ggtitle("") +
  theme(legend.position = "none",
        panel.background = element_rect(fill = alpha("#FFCC99", 0.5)),
         axis.text = element_text(size = 10),
        axis.title = element_text(size = 10))

gVolcano_HW2_heat <- ggplot(data=dat_genes_HW2_heat_ctrl, aes(log2FoldChange, log10padj))
gVolcano_HW2_heat + geom_point(aes(color = threshold), alpha=1, size=1) +
  scale_color_manual(values = DEGcolors) +
  scale_x_continuous(limits = c(-10, 10), breaks = seq(-10,10,2)) + 
  ylim(c(0, 20)) +
  xlab("log2 fold change") +
  ylab("-log10 p-value") + 
  #geom_text_repel(data = dat_genes_LPS_ctrl[1:15, ], aes(label = rownames(dat_genes_LPS_ctrl[1:15, ])), color = "black", size = 2.5, box.padding = unit(0.35, "lines")) +
  theme_bw() + ggtitle("") +
  theme(legend.position = "none",
        panel.background = element_rect(fill = alpha("#FFCC99", 0.5)),
         axis.text = element_text(size = 10),
        axis.title = element_text(size = 10))

gVolcano_WT1_heat <- ggplot(data=dat_genes_WT1_heat_ctrl, aes(log2FoldChange, log10padj))
gVolcano_WT1_heat + geom_point(aes(color = threshold), alpha=1, size=1) +
  scale_color_manual(values = DEGcolors) +
  scale_x_continuous(limits = c(-10, 10), breaks = seq(-10,10,2)) + 
  ylim(c(0, 20)) +
  xlab("log2 fold change") +
  ylab("-log10 p-value") + 
  #geom_text_repel(data = dat_genes_LPS_ctrl[1:15, ], aes(label = rownames(dat_genes_LPS_ctrl[1:15, ])), color = "black", size = 2.5, box.padding = unit(0.35, "lines")) +
  theme_bw() + ggtitle("") +
  theme(legend.position = "none",
        panel.background = element_rect(fill = alpha("#FFCC99", 0.5)),
         axis.text = element_text(size = 10),
        axis.title = element_text(size = 10))

gVolcano_WT2_heat <- ggplot(data=dat_genes_WT2_heat_ctrl, aes(log2FoldChange, log10padj))
gVolcano_WT2_heat + geom_point(aes(color = threshold), alpha=1, size=1) +
  scale_color_manual(values = DEGcolors) +
  scale_x_continuous(limits = c(-10, 10), breaks = seq(-10,10,2)) + 
  ylim(c(0, 20)) +
  xlab("log2 fold change") +
  ylab("-log10 p-value") + 
  #geom_text_repel(data = dat_genes_LPS_ctrl[1:15, ], aes(label = rownames(dat_genes_LPS_ctrl[1:15, ])), color = "black", size = 2.5, box.padding = unit(0.35, "lines")) +
  theme_bw() + ggtitle("") +
  theme(legend.position = "none",
        panel.background = element_rect(fill = alpha("#FFCC99", 0.5)),
         axis.text = element_text(size = 10),
        axis.title = element_text(size = 10))
```

### Antibiotics.Heat vs. Control Differential Expression for each colony
```{r}
##Highlight genes that have an absolute fold change > 2 and a padj < 0.01
res_HW1_anti.heat_ctrl$threshold <- ifelse(res_HW1_anti.heat_ctrl$padj < 0.01 & res_HW1_anti.heat_ctrl$log2FoldChange > 0, "Upregulated", ifelse(res_HW1_anti.heat_ctrl$padj < 0.01 & res_HW1_anti.heat_ctrl$log2FoldChange < 0, "Downregulated", "NA"))
res_HW1_anti.heat_ctrl$log10padj <- -log10(res_HW1_anti.heat_ctrl$padj)
dat_genes_HW1_anti.heat_ctrl <- data.frame(cbind(res_HW1_anti.heat_ctrl$log2FoldChange, res_HW1_anti.heat_ctrl$log10padj, res_HW1_anti.heat_ctrl$threshold), stringsAsFactors = FALSE)
colnames(dat_genes_HW1_anti.heat_ctrl) <- c("log2FoldChange", "log10padj", "threshold")
row.names(dat_genes_HW1_anti.heat_ctrl) <- res_HW1_anti.heat_ctrl$IDGeneInfo
#dat_genes_HW1_anti.heat_ctrl <- dat_genes_HW1_anti.heat_ctrl[order(dat_genes_HW1_anti.heat_ctrl$log2FoldChange, decreasing = TRUE),]
dat_genes_HW1_anti.heat_ctrl$log2FoldChange <- as.numeric(dat_genes_HW1_anti.heat_ctrl$log2FoldChange)
dat_genes_HW1_anti.heat_ctrl$log10padj <- as.numeric(dat_genes_HW1_anti.heat_ctrl$log10padj)
dat_genes_HW1_anti.heat_ctrl$threshold <- factor(dat_genes_HW1_anti.heat_ctrl$threshold, levels = c("Upregulated", "Downregulated", "NA"), ordered = TRUE)

res_HW2_anti.heat_ctrl$threshold <- ifelse(res_HW2_anti.heat_ctrl$padj < 0.01 & res_HW2_anti.heat_ctrl$log2FoldChange > 0, "Upregulated", ifelse(res_HW2_anti.heat_ctrl$padj < 0.01 & res_HW2_anti.heat_ctrl$log2FoldChange < 0, "Downregulated", "NA"))
res_HW2_anti.heat_ctrl$log10padj <- -log10(res_HW2_anti.heat_ctrl$padj)
dat_genes_HW2_anti.heat_ctrl <- data.frame(cbind(res_HW2_anti.heat_ctrl$log2FoldChange, res_HW2_anti.heat_ctrl$log10padj, res_HW2_anti.heat_ctrl$threshold), stringsAsFactors = FALSE)
colnames(dat_genes_HW2_anti.heat_ctrl) <- c("log2FoldChange", "log10padj", "threshold")
row.names(dat_genes_HW2_anti.heat_ctrl) <- res_HW2_anti.heat_ctrl$IDGeneInfo
#dat_genes_HW2_anti.heat_ctrl <- dat_genes_HW2_anti.heat_ctrl[order(dat_genes_HW2_anti.heat_ctrl$log2FoldChange, decreasing = TRUE),]
dat_genes_HW2_anti.heat_ctrl$log2FoldChange <- as.numeric(dat_genes_HW2_anti.heat_ctrl$log2FoldChange)
dat_genes_HW2_anti.heat_ctrl$log10padj <- as.numeric(dat_genes_HW2_anti.heat_ctrl$log10padj)
dat_genes_HW2_anti.heat_ctrl$threshold <- factor(dat_genes_HW2_anti.heat_ctrl$threshold, levels = c("Upregulated", "Downregulated", "NA"), ordered = TRUE)

res_WT1_anti.heat_ctrl$threshold <- ifelse(res_WT1_anti.heat_ctrl$padj < 0.01 & res_WT1_anti.heat_ctrl$log2FoldChange > 0, "Upregulated", ifelse(res_WT1_anti.heat_ctrl$padj < 0.01 & res_WT1_anti.heat_ctrl$log2FoldChange < 0, "Downregulated", "NA"))
res_WT1_anti.heat_ctrl$log10padj <- -log10(res_WT1_anti.heat_ctrl$padj)
dat_genes_WT1_anti.heat_ctrl <- data.frame(cbind(res_WT1_anti.heat_ctrl$log2FoldChange, res_WT1_anti.heat_ctrl$log10padj, res_WT1_anti.heat_ctrl$threshold), stringsAsFactors = FALSE)
colnames(dat_genes_WT1_anti.heat_ctrl) <- c("log2FoldChange", "log10padj", "threshold")
row.names(dat_genes_WT1_anti.heat_ctrl) <- res_WT1_anti.heat_ctrl$IDGeneInfo
#dat_genes_WT1_anti.heat_ctrl <- dat_genes_WT1_anti.heat_ctrl[order(dat_genes_WT1_anti.heat_ctrl$log2FoldChange, decreasing = TRUE),]
dat_genes_WT1_anti.heat_ctrl$log2FoldChange <- as.numeric(dat_genes_WT1_anti.heat_ctrl$log2FoldChange)
dat_genes_WT1_anti.heat_ctrl$log10padj <- as.numeric(dat_genes_WT1_anti.heat_ctrl$log10padj)
dat_genes_WT1_anti.heat_ctrl$threshold <- factor(dat_genes_WT1_anti.heat_ctrl$threshold, levels = c("Upregulated", "Downregulated", "NA"), ordered = TRUE)

res_WT2_anti.heat_ctrl$threshold <- ifelse(res_WT2_anti.heat_ctrl$padj < 0.01 & res_WT2_anti.heat_ctrl$log2FoldChange > 0, "Upregulated", ifelse(res_WT2_anti.heat_ctrl$padj < 0.01 & res_WT2_anti.heat_ctrl$log2FoldChange < 0, "Downregulated", "NA"))
res_WT2_anti.heat_ctrl$log10padj <- -log10(res_WT2_anti.heat_ctrl$padj)
dat_genes_WT2_anti.heat_ctrl <- data.frame(cbind(res_WT2_anti.heat_ctrl$log2FoldChange, res_WT2_anti.heat_ctrl$log10padj, res_WT2_anti.heat_ctrl$threshold), stringsAsFactors = FALSE)
colnames(dat_genes_WT2_anti.heat_ctrl) <- c("log2FoldChange", "log10padj", "threshold")
row.names(dat_genes_WT2_anti.heat_ctrl) <- res_WT2_anti.heat_ctrl$IDGeneInfo
#dat_genes_WT2_anti.heat_ctrl <- dat_genes_WT2_anti.heat_ctrl[order(dat_genes_WT2_anti.heat_ctrl$log2FoldChange, decreasing = TRUE),]
dat_genes_WT2_anti.heat_ctrl$log2FoldChange <- as.numeric(dat_genes_WT2_anti.heat_ctrl$log2FoldChange)
dat_genes_WT2_anti.heat_ctrl$log10padj <- as.numeric(dat_genes_WT2_anti.heat_ctrl$log10padj)
dat_genes_WT2_anti.heat_ctrl$threshold <- factor(dat_genes_WT2_anti.heat_ctrl$threshold, levels = c("Upregulated", "Downregulated", "NA"), ordered = TRUE)
```

```{r, warning = FALSE}
DEGcolors <- c("red", "blue", "dark grey")
pdf(file = "./outputs/DESeq-results/figures/Volcano_anti.heat_ctrl_colonies.pdf", height = 3, width = 4.25)
gVolcano_HW1_anti.heat <- ggplot(data=dat_genes_HW1_anti.heat_ctrl, aes(log2FoldChange, log10padj))
gVolcano_HW1_anti.heat + geom_point(aes(color = threshold), alpha=1, size=1) +
  scale_color_manual(values = DEGcolors) +
  scale_x_continuous(limits = c(-10, 10), breaks = seq(-10,10,2)) + 
  ylim(c(0, 20)) +
  xlab("log2 fold change") +
  ylab("-log10 p-value") + 
  #geom_text_repel(data = dat_genes_LPS_ctrl[1:15, ], aes(label = rownames(dat_genes_LPS_ctrl[1:15, ])), color = "black", size = 2.5, box.padding = unit(0.35, "lines")) +
  theme_bw() + ggtitle("") +
  theme(legend.position = "none",
        panel.background = element_rect(fill = alpha("#FFFF66", 0.5)),
         axis.text = element_text(size = 10),
        axis.title = element_text(size = 10))

gVolcano_HW2_anti.heat <- ggplot(data=dat_genes_HW2_anti.heat_ctrl, aes(log2FoldChange, log10padj))
gVolcano_HW2_anti.heat + geom_point(aes(color = threshold), alpha=1, size=1) +
  scale_color_manual(values = DEGcolors) +
  scale_x_continuous(limits = c(-10, 10), breaks = seq(-10,10,2)) + 
  ylim(c(0, 20)) +
  xlab("log2 fold change") +
  ylab("-log10 p-value") + 
  #geom_text_repel(data = dat_genes_LPS_ctrl[1:15, ], aes(label = rownames(dat_genes_LPS_ctrl[1:15, ])), color = "black", size = 2.5, box.padding = unit(0.35, "lines")) +
  theme_bw() + ggtitle("") +
  theme(legend.position = "none",
        panel.background = element_rect(fill = alpha("#FFFF66", 0.5)),
         axis.text = element_text(size = 10),
        axis.title = element_text(size = 10))

gVolcano_WT1_anti.heat <- ggplot(data=dat_genes_WT1_anti.heat_ctrl, aes(log2FoldChange, log10padj))
gVolcano_WT1_anti.heat + geom_point(aes(color = threshold), alpha=1, size=1) +
  scale_color_manual(values = DEGcolors) +
  scale_x_continuous(limits = c(-10, 10), breaks = seq(-10,10,2)) + 
  ylim(c(0, 20)) +
  xlab("log2 fold change") +
  ylab("-log10 p-value") + 
  #geom_text_repel(data = dat_genes_LPS_ctrl[1:15, ], aes(label = rownames(dat_genes_LPS_ctrl[1:15, ])), color = "black", size = 2.5, box.padding = unit(0.35, "lines")) +
  theme_bw() + ggtitle("") +
  theme(legend.position = "none",
        panel.background = element_rect(fill = alpha("#FFFF66", 0.5)),
         axis.text = element_text(size = 10),
        axis.title = element_text(size = 10))

gVolcano_WT2_anti.heat <- ggplot(data=dat_genes_WT2_anti.heat_ctrl, aes(log2FoldChange, log10padj))
gVolcano_WT2_anti.heat + geom_point(aes(color = threshold), alpha=1, size=1) +
  scale_color_manual(values = DEGcolors) +
  scale_x_continuous(limits = c(-10, 10), breaks = seq(-10,10,2)) + 
  ylim(c(0, 20)) +
  xlab("log2 fold change") +
  ylab("-log10 p-value") + 
  #geom_text_repel(data = dat_genes_LPS_ctrl[1:15, ], aes(label = rownames(dat_genes_LPS_ctrl[1:15, ])), color = "black", size = 2.5, box.padding = unit(0.35, "lines")) +
  theme_bw() + ggtitle("") +
  theme(legend.position = "none",
        panel.background = element_rect(fill = alpha("#FFFF66", 0.5)),
         axis.text = element_text(size = 10),
        axis.title = element_text(size = 10))
```


### LPS vs. Control Differential Expression - normal LFC shrinkage
```{r}
##Highlight genes that have an absolute fold change > 2 and a padj < 0.01
res_LPS_normal$threshold <- ifelse(res_LPS_normal$padj < 0.01 & res_LPS_normal$log2FoldChange > 0, "Upregulated", ifelse(res_LPS_normal$padj < 0.01 & res_LPS_normal$log2FoldChange < -0, "Downregulated", "NA"))
res_LPS_normal$log10padj <- -log10(res_LPS_normal$padj)
dat_genes_LPS_ctrl <- data.frame(cbind(res_LPS_normal$log2FoldChange, res_LPS_normal$log10padj, res_LPS_normal$threshold), stringsAsFactors = FALSE)
colnames(dat_genes_LPS_ctrl) <- c("log2FoldChange", "log10padj", "threshold")
row.names(dat_genes_LPS_ctrl) <- res_LPS_normal$IDGeneInfo
dat_genes_LPS_ctrl <- dat_genes_LPS_ctrl[order(dat_genes_LPS_ctrl$log2FoldChange, decreasing = TRUE),]
dat_genes_LPS_ctrl$log2FoldChange <- as.numeric(dat_genes_LPS_ctrl$log2FoldChange)
dat_genes_LPS_ctrl$log10padj <- as.numeric(dat_genes_LPS_ctrl$log10padj)
dat_genes_LPS_ctrl$threshold <- factor(dat_genes_LPS_ctrl$threshold, levels = c("Upregulated", "Downregulated", "NA"), ordered = TRUE)
```
```{r}
class(dat_genes_LPS_ctrl$log2FoldChange)
class(res_LPS_normal$log2FoldChange)
```

```{r, warning = FALSE}
DEGcolors <- c("red", "blue", "dark grey")
pdf(file = "~/computing/scripts/EAPSI_LPS-master/DESeqresults_Pdam/figures/Volcano_LPS-ctrl_normal.pdf", height = 2.95, width = 4.25)
gVolcano_LPS_ctrl <- ggplot(data=dat_genes_LPS_ctrl, aes(log2FoldChange, log10padj))
gVolcano_LPS_ctrl + geom_point(aes(color = threshold), alpha=1, size=2) +
  scale_color_manual(values = DEGcolors) +
  scale_x_continuous(limits = c(-3,3), breaks = seq(-3,3,1)) + 
  ylim(c(0, 80)) +
  xlab("log2 fold change") +
  ylab("-log10 p-value") + 
  #geom_text_repel(data = dat_genes_LPS_ctrl[1:10, ], aes(label = rownames(dat_genes_LPS_ctrl[1:10, ])), color = "black", size = 2.5, box.padding = unit(0.35, "lines")) +
  theme_bw() +
  theme(legend.position = "none") +
  ggtitle("Volcano Plot")
```

### LPS vs. Control Differential Expression - apeglm LFC shrinkage
```{r}
##Highlight genes that have an absolute fold change > 2 and a padj < 0.01
res_LPS_apeglm$threshold <- ifelse(res_LPS_apeglm$padj < 0.01 & res_LPS_apeglm$log2FoldChange > 0, "Upregulated", ifelse(res_LPS_apeglm$padj < 0.01 & res_LPS_apeglm$log2FoldChange < -0, "Downregulated", "NA"))
res_LPS_apeglm$log10padj <- -log10(res_LPS_apeglm$padj)
dat_genes_LPS_ctrl <- data.frame(cbind(res_LPS_apeglm$log2FoldChange, res_LPS_apeglm$log10padj, res_LPS_apeglm$threshold), stringsAsFactors = FALSE)
colnames(dat_genes_LPS_ctrl) <- c("log2FoldChange", "log10padj", "threshold")
row.names(dat_genes_LPS_ctrl) <- res_LPS_apeglm$IDGeneInfo
dat_genes_LPS_ctrl$log2FoldChange <- as.numeric(dat_genes_LPS_ctrl$log2FoldChange)
dat_genes_LPS_ctrl$log10padj <- as.numeric(dat_genes_LPS_ctrl$log10padj)
dat_genes_LPS_ctrl$threshold <- factor(dat_genes_LPS_ctrl$threshold, levels = c("Upregulated", "Downregulated", "NA"), ordered = TRUE)
dat_genes_LPS_ctrl <- dat_genes_LPS_ctrl[order(dat_genes_LPS_ctrl$log10padj, decreasing = TRUE),]
```
```{r}
class(dat_genes_LPS_ctrl$log2FoldChange)
class(res_LPS_apeglm$log2FoldChange)
```

```{r, warning = FALSE}
DEGcolors <- c("red", "blue", "dark grey")
pdf(file = "~/computing/scripts/EAPSI_LPS-master/DESeqresults_Pdam/figures/Volcano_LPS-ctrl_apeglm.pdf", height = 8.5, width = 11)
gVolcano_LPS_ctrl <- ggplot(data=dat_genes_LPS_ctrl, aes(log2FoldChange, log10padj))
gVolcano_LPS_ctrl + geom_point(aes(color = threshold), alpha=1, size=2) +
  scale_color_manual(values = DEGcolors) +
  scale_x_continuous(limits = c(-4,4), breaks = seq(-4,4,1)) + 
  ylim(c(0, 80)) +
  xlab("log2 fold change") +
  ylab("-log10 p-value") + 
  geom_text_repel(data = dat_genes_LPS_ctrl[1:12, ], aes(label = rownames(dat_genes_LPS_ctrl[1:12, ])), color = "black", size = 3, box.padding = unit(0.2, "lines")) +
  theme_bw() +
  theme(legend.position = "none") +
  ggtitle("Volcano Plot")
```
